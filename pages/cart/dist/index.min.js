"use strict";var _asyncWX=require("../../utils/asyncWX.js"),_runtime=_interopRequireDefault(require("../../lib/runtime/runtime"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Page({data:{address:{},cart:[],allChecked:!1,totalPrice:0,totalNum:0},onShow:function(){var e=wx.getStorageSync("address"),t=wx.getStorageSync("cart")||[];e.all=e.provinceName+e.cityName+e.countyName+e.detailInfo,this.setCart(t),this.setData({address:e})},onLoad:function(){},handleChooseAddress:function(){wx.getSetting({success:function(e){var t=e.authSetting["scope.address"];!0!==t&&void 0!==t||wx.chooseAddress({success:function(e){console.log(e),wx.setStorageSync("address",e)}})}})},handleItemChange:function(e){var t=e.currentTarget.dataset.id,a=this.data.cart,n=a.findIndex(function(e){return e.goods_id===t});a[n].checked=!a[n].checked,this.setCart(a)},setCart:function(e){var t=0,a=0,n=!0;e.forEach(function(e){e.checked?(t+=e.goods_price*e.num,a+=e.num):n=!1}),n=0!=e.length&&n,this.setData({cart:e,allChecked:n,totalPrice:t,totalNum:a}),wx.setStorageSync("cart",e)},handleItemAllCheck:function(){var e=this.data,t=e.cart,a=e.allChecked;a=!a,t.forEach(function(e){return e.checked=a}),this.setData({cart:t,allChecked:a})},handleItemNumEdit:function(t){var a,n,r,s,c,i;return _runtime.default.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.currentTarget.dataset,n=a.operation,r=a.id,s=this.data.cart,c=s.findIndex(function(e){return e.goods_id===r}),1===s[c].num&&-1===n)return e.next=6,_runtime.default.awrap((0,_asyncWX.showModel)({content:"您是否要删除?"}));e.next=11;break;case 6:i=e.sent,console.log(i),i.confirm&&(s.splice(c,1),this.setCart(s)),e.next=13;break;case 11:s[c].num+=n,this.setCart(s);case 13:case"end":return e.stop()}},null,this)},handlePay:function(){var t,a,n;return _runtime.default.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.data,a=t.address,n=t.totalNum,a.userName){e.next=5;break}return e.next=4,_runtime.default.awrap((0,_asyncWX.showToast)({title:"您还没有选择收货地址"}));case 4:return e.abrupt("return");case 5:if(0===n)return e.next=8,_runtime.default.awrap((0,_asyncWX.showToast)({title:"您还没有选购商品"}));e.next=9;break;case 8:return e.abrupt("return");case 9:wx.navigateTo({url:"/pages/pay/index"});case 10:case"end":return e.stop()}},null,this)}});
//# sourceMappingURL=index.min.js.map
