{"version":3,"sources":["index.js"],"names":["Page","data","MenuList","MenuDetail","currentIndex","scrollTop","CartData","onLoad","options","wx","getStorageSync","getCartData","console","log","Date","now","time","map","v","cat_name","children","setData","url","res","setStorageSync","handleMenuList","e","index","currentTarget","dataset"],"mappings":";;AAAA;;AACA;;;;AACAA,IAAI,CAAC;AACH;;;AAGAC,EAAAA,IAAI,EAAE;AACJC,IAAAA,QAAQ,EAAE,EADN;AAEJC,IAAAA,UAAU,EAAE,EAFR;AAGJC,IAAAA,YAAY,EAAE,CAHV;AAIJC,IAAAA,SAAS,EAAE;AAJP,GAJH;AAUHC,EAAAA,QAAQ,EAAE,EAVP;;AAWH;;;AAGAC,EAAAA,MAAM,EAAE,gBAAUC,OAAV,EAAmB;AACzB;AACA;AACA;AAEA;AACA,QAAMF,QAAQ,GAAGG,EAAE,CAACC,cAAH,CAAkB,UAAlB,CAAjB;;AACA,QAAI,CAACJ,QAAL,EAAe;AACb;AACA,WAAKK,WAAL;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;AACD,KAJD,MAIO;AACL;AACA,UAAIC,IAAI,CAACC,GAAL,KAAaT,QAAQ,CAACU,IAAtB,GAA6B,OAAO,EAAxC,EAA4C;AAC1C;AACA,aAAKL,WAAL;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACD,OAJD,MAIO;AACL;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AACA,aAAKP,QAAL,GAAgBA,QAAQ,CAACL,IAAzB;AACAW,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAKP,QAAjB;AACA,YAAIJ,QAAQ,GAAG,KAAKI,QAAL,CAAcW,GAAd,CAAkB,UAACC,CAAD;AAAA,iBAAOA,CAAC,CAACC,QAAT;AAAA,SAAlB,CAAf,CALK,CAML;;AACA,YAAIhB,UAAU,GAAG,KAAKG,QAAL,CAAc,CAAd,EAAiBc,QAAlC;AAEA,aAAKC,OAAL,CAAa;AACXnB,UAAAA,QAAQ,EAARA,QADW;AAEXC,UAAAA,UAAU,EAAVA;AAFW,SAAb;AAID;AACF;AACF,GA9CE;AA+CGQ,EAAAA,WA/CH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6CAwEiB,sBAAQ;AAAEW,cAAAA,GAAG,EAAE;AAAP,aAAR,CAxEjB;;AAAA;AAwEKC,YAAAA,GAxEL;AAyED,iBAAKjB,QAAL,GAAgBiB,GAAhB;AACAd,YAAAA,EAAE,CAACe,cAAH,CAAkB,UAAlB,EAA8B;AAAER,cAAAA,IAAI,EAAEF,IAAI,CAACC,GAAL,EAAR;AAAoBd,cAAAA,IAAI,EAAE,KAAKK;AAA/B,aAA9B;AACIJ,YAAAA,QA3EH,GA2Ec,KAAKI,QAAL,CAAcW,GAAd,CAAkB,UAACC,CAAD;AAAA,qBAAOA,CAAC,CAACC,QAAT;AAAA,aAAlB,CA3Ed;AA4EGhB,YAAAA,UA5EH,GA4EgB,KAAKG,QAAL,CAAc,CAAd,EAAiBc,QA5EjC;AA6ED,iBAAKC,OAAL,CAAa;AACXnB,cAAAA,QAAQ,EAARA,QADW;AAEXC,cAAAA,UAAU,EAAVA;AAFW,aAAb;;AA7EC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAkFHsB,EAAAA,cAlFG,0BAkFYC,CAlFZ,EAkFe;AAAA,QACVC,KADU,GACAD,CAAC,CAACE,aAAF,CAAgBC,OADhB,CACVF,KADU;AAEhB,QAAIxB,UAAU,GAAG,KAAKG,QAAL,CAAcqB,KAAd,EAAqBP,QAAtC;AACA,SAAKC,OAAL,CAAa;AACXjB,MAAAA,YAAY,EAAEuB,KADH;AAEXxB,MAAAA,UAAU,EAAVA,UAFW;AAGXE,MAAAA,SAAS,EAAE;AAHA,KAAb,EAHgB,CAShB;AACD;AA5FE,CAAD,CAAJ","sourcesContent":["import { request } from \"../../request/request.js\";\nimport regeneratorRuntime from \"../../lib/runtime/runtime\";\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    MenuList: [],\n    MenuDetail: [],\n    currentIndex: 0,\n    scrollTop: 0,\n  },\n  CartData: [],\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad: function (options) {\n    // this.getCartData();\n    //判断本地存储中有无旧数据 如果没有就发送新请求\n    // 如果有旧的数据 就判断是否过期 没有过期就使用\n\n    // 获取本地存储的数据\n    const CartData = wx.getStorageSync(\"cartData\");\n    if (!CartData) {\n      // 不存在 发送请求获取数据\n      this.getCartData();\n      console.log(\"不存在\");\n    } else {\n      // 有旧的数据 定义过期时间\n      if (Date.now() - CartData.time > 1000 * 10) {\n        // 重新发送请求\n        this.getCartData();\n        console.log(\"不能使用旧的数据\");\n      } else {\n        // 可以使用旧数据\n        console.log(\"可以使用旧数据\");\n        this.CartData = CartData.data;\n        console.log(this.CartData);\n        let MenuList = this.CartData.map((v) => v.cat_name);\n        // 右侧\n        let MenuDetail = this.CartData[0].children;\n\n        this.setData({\n          MenuList,\n          MenuDetail,\n        });\n      }\n    }\n  },\n  async getCartData() {\n    // request({\n    //   url: \"/categories\",\n    // }).then((res) => {\n    //   this.CartData = res.data.message;\n    //   // 在此处可以确定数据已经返回来了\n    //   // 把接口的数据存入到本地存储中\n    //   wx.setStorageSync(\"cartData\", { time: Date.now(), data: this.CartData });\n    //   // wx.getStorage({\n    //   //   key: \"cartData\",\n    //   //   success(res) {\n    //   //     console.log(res.data);\n    //   //   },\n    //   // });\n    //   // 把数据存储在\n    //   // 左侧菜单信息\n    //   let MenuList = this.CartData.map((v) => v.cat_name);\n    //   // 右侧\n    //   let MenuDetail = this.CartData[0].children;\n    //   this.setData({\n    //     MenuList,\n    //     MenuDetail,\n    //   });\n    // });\n    // 使用es7的async和await来发请求\n    const res = await request({ url: \"/categories\" });\n    this.CartData = res;\n    wx.setStorageSync(\"cartData\", { time: Date.now(), data: this.CartData });\n    let MenuList = this.CartData.map((v) => v.cat_name);\n    let MenuDetail = this.CartData[0].children;\n    this.setData({\n      MenuList,\n      MenuDetail,\n    });\n  },\n  handleMenuList(e) {\n    let { index } = e.currentTarget.dataset;\n    let MenuDetail = this.CartData[index].children;\n    this.setData({\n      currentIndex: index,\n      MenuDetail,\n      scrollTop: 0,\n    });\n\n    // 重新设置scrollView标签的距离顶部的距离： scrollTop\n  },\n});\n"],"file":"index.dev.js"}