{"version":3,"sources":["index.js"],"names":["Page","data","tabs","id","value","isActive","goodList","totalPage","Queryparams","query","cid","pagenum","pagesize","onLoad","options","getGoodList","handleTabsItemChange","e","index","detail","forEach","v","i","setData","url","res","total","Math","ceil","goods","wx","stopPullDownRefresh","onReachBottom","showToast","title","onPullDownRefresh"],"mappings":"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","sourcesContent":["import { request } from \"../../request/request.js\";\nimport regeneratorRuntime from \"../../lib/runtime/runtime\";\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    tabs: [\n      {\n        id: 0,\n        value: \"综合\",\n        isActive: true,\n      },\n      {\n        id: 1,\n        value: \"销量\",\n        isActive: false,\n      },\n      {\n        id: 2,\n        value: \"价格\",\n        isActive: false,\n      },\n    ],\n    goodList: [],\n    totalPage: \"\",\n  },\n\n  // 接口要的参数\n  Queryparams: {\n    query: \"\",\n    cid: \"\",\n    pagenum: 1,\n    pagesize: 10,\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad: function (options) {\n    this.Queryparams.cid = options.cid;\n    this.getGoodList();\n  },\n\n  handleTabsItemChange(e) {\n    const { index } = e.detail;\n    // 修改原数组\n    const { tabs } = this.data;\n    tabs.forEach((v, i) => {\n      i === index ? (v.isActive = true) : (v.isActive = false);\n    });\n    this.setData({\n      tabs,\n    });\n  },\n  // 获取商品列表数据\n  async getGoodList() {\n    const res = await request({ url: \"/goods/search\", data: this.Queryparams });\n    let pagenum = 1;\n    let total = res.total;\n    this.totalPage = Math.ceil(total / this.Queryparams.pagesize);\n    this.setData({\n      // 拼接的数组旧+新1\n      goodList: [...this.data.goodList, ...res.goods],\n    });\n    // 关闭下拉刷新\n    wx.stopPullDownRefresh();\n  },\n  onReachBottom() {\n    // console.log(\"触底\");\n    if (this.Queryparams.pagenum >= this.totalPage) {\n      wx.showToast({\n        title: \"没有下一页了\",\n      });\n    } else {\n      this.Queryparams.pagenum++;\n      this.getGoodList();\n    }\n  },\n  onPullDownRefresh() {\n    // 重置数据\n    this.setData({\n      goodList: [],\n    });\n    // 重置页码\n    this.Queryparams.pagenum = 1;\n    // 重新发送请求\n    this.getGoodList();\n  },\n});\n"],"file":"index.dev.js"}