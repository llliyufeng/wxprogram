{"version":3,"sources":["index.js"],"names":["_request","require","_runtime","_interopRequireDefault","Page","data","tabs","id","value","isActive","totalPage","Queryparams","pagesize","options","query","cid","getGoodList","handleTabsItemChange","e","index","detail","this","forEach","v","i","onLoad","res","total","async","_context","prev","next","awrap","request","url","sent","setData","Math","ceil","goodList","concat","_toConsumableArray","goods","wx","stopPullDownRefresh","stop","onReachBottom","pagenum","showToast","title"],"mappings":"aAAA,IAAAA,SAAAC,QAAA,4BACAC,SAAAC,uBAAAF,QAAA,ujBADAG,KAAA,CAMEC,KAAM,CACJC,KAAM,CACJ,CACEC,GAAI,EACJC,MAAO,KACPC,UAAU,GAEZ,CACEF,GAAI,EACJC,MAAO,KAbVC,UAAA,GAgBC,CACEF,GAAI,EAbJC,MAAA,KACAC,UACF,IAGEA,SAAQ,GAHVC,UAKA,IAAAC,YAKA,CACEJ,MADF,GAEEC,IAAAA,GACAC,QAAAA,EAHFG,SAZE,IAuBND,OAAAA,SAAaE,GACXC,KAAKH,YADMI,IAAAF,EAAAE,IAEXA,KAAKC,eAFMC,qBA7Bf,SAEKC,GAAA,IA0COC,EAAUD,EAAEE,OAAZD,MAEAb,EAASe,KAAKhB,KAAdC,KACRA,EAAKgB,QAAQ,SAACC,EAAGC,GATXD,EAAAd,SAARgB,IAAQN,IAENE,KAAKL,QAAAA,CAtCJV,KAAAA,KA4COA,YA9CZ,WAAA,IAAAoB,EAAAC,EAAA,OAAAzB,SAAA,QAAA0B,MAAA,SAAAC,GAAA,OAAA,OAAAA,EAAAC,KAAAD,EAAAE,MAAA,KAAA,EAAA,OAAAF,EAAAE,KAAA,EAAA7B,SAAA,QAAA8B,OA+CiB,EAAAhC,SAAAiC,SAAIT,CAAJU,IAAU,gBAAA7B,KAAAgB,KAAAV,eA/C3B,KAAA,EA+CSW,EA/CTO,EAAAM,KAgDM,EADFR,EAAAD,EAAAC,MAGAN,KAAKe,UAAQC,KAAAC,KAAAX,EAAAN,KAAAV,YAAAC,UACXN,KAAAA,QAAAA,CAjDDiC,SAAA,GAAAC,OAAAC,mBAAApB,KAAAhB,KAAAkC,UAAAE,mBAAAf,EAAAgB,UAAAC,GAAAC,sBAFL,KAAA,EAAA,IAAA,MAAA,OAAAf,EAAAgB,SAAA,KAAAxB,OAEKyB,cAFL,WAEKzB,KAAAV,YAAAoC,SAAA1B,KAAAX,UAAAiC,GAAAK,UAAA,CAAAC,MAAA,YAsDyB5B,KAAAV,YAtDzBoC,UAyEC1B,KAAKL,gBAlBH+B,kBAzDR,WA2DI1B,KAAAe,QAAK1B,CACL6B,SAAA,KAAalB,KAAAV,YAIboC,QAAA,EACAJ,KAAAA","file":"index.min.js","sourcesContent":["import { request } from \"../../request/request.js\";\nimport regeneratorRuntime from \"../../lib/runtime/runtime\";\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    tabs: [\n      {\n        id: 0,\n        value: \"综合\",\n        isActive: true,\n      },\n      {\n        id: 1,\n        value: \"销量\",\n        isActive: false,\n      },\n      {\n        id: 2,\n        value: \"价格\",\n        isActive: false,\n      },\n    ],\n    goodList: [],\n    totalPage: \"\",\n  },\n\n  // 接口要的参数\n  Queryparams: {\n    query: \"\",\n    cid: \"\",\n    pagenum: 1,\n    pagesize: 10,\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad: function (options) {\n    this.Queryparams.cid = options.cid;\n    this.getGoodList();\n  },\n\n  handleTabsItemChange(e) {\n    const { index } = e.detail;\n    // 修改原数组\n    const { tabs } = this.data;\n    tabs.forEach((v, i) => {\n      i === index ? (v.isActive = true) : (v.isActive = false);\n    });\n    this.setData({\n      tabs,\n    });\n  },\n  // 获取商品列表数据\n  async getGoodList() {\n    const res = await request({ url: \"/goods/search\", data: this.Queryparams });\n    let pagenum = 1;\n    let total = res.total;\n    this.totalPage = Math.ceil(total / this.Queryparams.pagesize);\n    this.setData({\n      // 拼接的数组旧+新1\n      goodList: [...this.data.goodList, ...res.goods],\n    });\n    // 关闭下拉刷新\n    wx.stopPullDownRefresh();\n  },\n  onReachBottom() {\n    // console.log(\"触底\");\n    if (this.Queryparams.pagenum >= this.totalPage) {\n      wx.showToast({\n        title: \"没有下一页了\",\n      });\n    } else {\n      this.Queryparams.pagenum++;\n      this.getGoodList();\n    }\n  },\n  onPullDownRefresh() {\n    // 重置数据\n    this.setData({\n      goodList: [],\n    });\n    // 重置页码\n    this.Queryparams.pagenum = 1;\n    // 重新发送请求\n    this.getGoodList();\n  },\n});\n"]}